---
title: "TIL - 2024. 07."
---

[:material-arrow-left-bold: 이전 페이지](../index.md){ .md-button }  

## *2024. 07. 14*
### C# 2차원 배열
[https://stackoverflow.com/questions/12567329/multidimensional-array-vs](https://stackoverflow.com/questions/12567329/multidimensional-array-vs){:target="_blank"}  
C#에서 2차원 배열 선언하는 방법 및 활용하는 방법.

- `double[][] x`처럼 선언하면 x안에 들어있는 각 배열의 크기가 달라도 상관 없음
- `double[,]`처럼 선언하면 정해진 크기대로 만들어지는듯.

[14174번: Block Game (acmicpc.net)](https://www.acmicpc.net/problem/14174){:target="_blank"} 문제를 풀때 활용했다.

### mkdocs에서 링크 클릭할때 새로운 창에서 뜨도록
[[markdown] open a link with a new tab · squidfunk/mkdocs-material · Discussion #3660 (github.com)](https://github.com/squidfunk/mkdocs-material/discussions/3660){:target="_blank"}  
위의 디스커션에 나온 내용에 따르면 아래처럼 작성하면 되는듯하다.
```
[name](link) <- 기존
[name](link){:target="_blank"} <- 새 탭에서 링크 열기
```
디스커션 계속 읽다 보면 누군가가 자동으로 링크 걸린 것을 새 탭으로 열게 해주는 플러그인도 만들어놓았고 insiders에 관련 기능이 구현되어 있다는 이야기도 있지만, 이 페이지에 있는 `이전 페이지`같은 버튼들이 링크처럼 작성되어 있어서 영향을 받을 수도 있어보인다. `{:target="_blank"}`를 사용하는 것으로 만족하기로 했다.


## *2024. 07. 15*
### .gitkeep 파일
예전에 어디선가 보고 잊고 있다가 이런 저런 repo들 돌아다니다가 다시 발견. 로그 파일 저장 위치 같이 처음에는 비어있지만 폴더가 존재해야 나중에 그 위치에 파일이 문제 없이 쌓이는 경우에 빈 폴더에 해당 비어있는 .gitkeep이라는 이름의 파일을 넣어놓는 식으로 활용한다. git은 비어있는 폴더는 무시하고 넘어가기 때문에 이렇게 해야 폴더가 남아있음.

사실 꼭 저 이름이 아니어도 같은 방식으로 작동하긴 할테지만 많이 쓰이는 컨벤션이니 기억해두고 다음에는 꼭 써먹자.

### celery vs huey
[is this to replace Celery · Issue #64 · coleifer/huey (github.com)](https://github.com/coleifer/huey/issues/64){:target="_blank"}

celery보다 가벼운 huey. huey 만든 분이 직접 장단점 적음. 2주 전 업데이트.
```
I'd write celery, more like smellery.

Seriously though I don't know what all has changed in celery over the years (or the other popular projects in this space). huey's gotten better at a few things since I wrote that, though, so I can write about that. Over the years, Huey's added:
- different worker types, so it can handle a variety of workloads
- priorities
- locking
- pipelines/chaining tasks
- signalling / much more powerful hooks for extending and introspecting huey
- controllable shutdown behavior - graceful or hard
- additional storage backends for different types of deployments

Things huey is not great for:
- at-least-once tasks (we are at-most-once as it is simpler)
- complex pipelines / airflow-type stuff
- monitoring tooling / etc is not on the level of celery ecosystem

huey still remains stupid simple to get going with and can go rather far. I think the users who like huey like it quite well, and that's what I'm going for here.
```

### 긴 코드블록 wrap하기
위의 코드블록에 따로 처리를 하지 않으면 옆으로 스크롤을 해야 하는 문제가 생긴다. 

[https://stackoverflow.com/a/56469907](https://stackoverflow.com/a/56469907)

여기에 있는 내용을 따라서 아래의 내용을 css파일에 추가해서 wrap이 되도록 했다.
```css
code {
  white-space : pre-wrap !important;
}
```

## *2024. 07. 16*
### mkdocs에서 sitemap.xml이 제대로 생성되지 않음
- [haklee.com/sitemap.xml](https://haklee.com/sitemap.xml){:target="_blank"}주소로 들어갔을때 나오는 sitemap 정보에 제대로 된 주소가 들어있지 않고 `None`이 등장했다.
- `mkdocs sitemap broken` 키워드로 검색해보니 다음과 같은 링크가 나왔다.
    - [Instant reload site map not generating correctly · Issue #2253 · squidfunk/mkdocs-material · GitHub](https://github.com/squidfunk/mkdocs-material/issues/2253){:target="_blank"}.
- 문제 해결 방법은 `mkdocs.yml`에 `site_url`속성을 만들어주면 되는 것이었다. 다행히도 매우 간단한 해결 방법.

### jetbrains에서 파이썬 유저들을 대상으로 진행한 2022년 서베이
[Python Developers Survey 2022 Results (jetbrains.com)](https://lp.jetbrains.com/python-developers-survey-2022/){:target="_blank"}

흥미로운 내용들이 많다. 나는 `flask vs django vs fastapi` 키워드로 검색하다가 찾았는데, 서베이 내용에 점유율이 39% : 39% : 25%로 나왔다. 참고로 복수 선택이 가능해서 합이 100%가 넘을 수 있음. 의외로 사람들이 docker를 안 쓴다. `How do you develop for the cloud?` 질문에 대한 답에 `In Docker containers`가 40% 정도 된다.

## *2024. 07. 17*
### yaml에 설정 복붙 기능
[How to build differently configured celery workers using docker-compose? - Stack Overflow](https://stackoverflow.com/questions/66409884/how-to-build-differently-configured-celery-workers-using-docker-compose){:target="_blank"}  
큐를 다르게 설정한 celery worker들을 여럿 올릴때 기본 설정들을 중복해서 쓰는 것을 막기 위한 방법. 위 글에서는 이런 식으로 썼다.
```yaml
version: '3'

services:
  worker-a: &default
    image: alpine
    command: env
    environment:
      WORKER_TYPE: a_setting
    # ... more definitions

  worker-b:
    <<: *default
    environment:
      WORKER_TYPE: b_setting
```
### django의 project와 app 차이
[Writing your first Django app, part 1 | Django documentation | Django (djangoproject.com)](https://docs.djangoproject.com/en/5.0/intro/tutorial01/#creating-the-polls-app){:target="_blank"}  

> - An app is a web application that does something
> - A project is a collection of configuration and apps for a particular website
> - A project can contain multiple apps. An app can be in multiple projects.

튜토리얼을 따라가다 보면 manage.py는 프로젝트를 생성할때 만들어지는데 `$ python manage.py startapp polls` 같은 방식으로 app을 생성함. 그렇다면 한 app이 여러 프로젝트에 속하게 하기 위해서는 직접 세팅해주어야 하는 값들이 있을 거라는 말인가...? 한 app이 여러 프로젝트에 속하는 상황의 예시를 나중에 찾게 된다면 다시 생각해보면 되겠다.

## *2024. 07. 18*
### 개인 github을 nuget package server로 사용하기
[Using Github as Private Nuget Package Server and Share Your Packages - CodeProject](https://www.codeproject.com/Tips/5292364/Using-Github-as-Private-Nuget-Package-Server-and-S){:target="_blank"}  
위 링크 내용을 나중에 실습해볼것.

### celery 실전용 팁들
[10 Essential Lessons for Running Celery Workloads in Production | by Hank Ehly | Medium](https://medium.com/@hankehly/10-essential-lessons-for-running-celery-workloads-in-production-720ce5a05a17){:target="_blank"}  
유용한 팁들이 많았다. 그 중에서도 다음의 항목들이 지금 활용하기에 좋았다.

- 6) Use flower (the monitoring tool)
    - 여기에서는 오토스케일이 적용된 환경에서 떠있던 워커들이 죽는 것까지 고려해서 `FLOWER_PURGE_OFFLINE_WORKERS: 60` 옵션 주는 걸 설명함.
- 7) Broker (Redis, RabbitMQ, SQS) characteristics and points to keep in mind
    - 여기에서는 브로커를 어떤 걸 사용하면 어떤 점이 좋은지/문제가 있을 수 있는지 잘 설명.

## *2024. 07. 19*
### docker compose를 쓸때 flower 컨테이너를 내렸다가 다시 올려도 정보 유지하게 하는 방법.
[Persistence not working with docker compose ? · Issue #1145 · mher/flower (github.com)](https://github.com/mher/flower/issues/1145){:target="_blank"}  
위의 이슈 끝에 유저 `rajkumarvenkatasamy`가 남겨놓은 내용을 따라하면 잘 작동한다. 대신 아래와 같은 한계가 있긴 하지만, 그래도 태스크들에 대한 로깅이 가능하다는 점에서 쓸만해보인다.
> - Data is being retained across container restarts
> - The main status page shows reset statistics. 
> - You have to click through to the "active" , "processed", or "failed" tabs to see the previous tasks.

### semver의 backward compatible의 정의는 어떻게 되나요?
[Definition of backwards compatibility · Issue #256 · semver/semver (github.com)](https://github.com/semver/semver/issues/256){:target="_blank"}  
유의적 버전에서 버전 번호를 올리는 상황을 정의할때 '이전 버전과 호환이 되는지'가 중요한 기준이 되는 것에 비해 호환이 어떻게 정의되는지를 자세히 다루지 않은 것에서 비롯된 이슈. 흥미로운 이야기를 하는 것 같은데 아직 자세히 읽어보지 않았다. 나중에 읽고 정리해보면 좋을듯하다.


## *2024. 07. 20*
### C#에서 배열의 마지막 아이템 얻는 방법
[c# - Finding the last index of an array - Stack Overflow](https://stackoverflow.com/questions/1056749/finding-the-last-index-of-an-array){:target="_blank"}  
여기에서 아래의 방법이 굉장히 인상깊었음.
```c#
int[] array = { 1, 3, 5 };
var lastItem = array[^1]; // 5
```

## *2024. 07. 21*
### postgresql에서 insert/update/delete한 행의 정보 가져오기
[PostgreSQL: Documentation: 16: 6.4. Returning Data from Modified Rows](https://www.postgresql.org/docs/current/dml-returning.html){:target="_blank"}  
다음과 같이 정보를 가져오는 것이 가능하다.
```postgresql
UPDATE products SET price = price * 1.10
  WHERE price <= 99.99
  RETURNING name, price AS new_price;
```
이를 kysely를 쓰면 다음과 같이 사용할 수 있다.
```js
let insertResult = await db
    .insertInto('MySchema.MyTable')
    .values({...}) // 내용물을 뭔가 넣었다고 하자.
    .returning('uuid') // 이때 uuid가 자동으로 생성되는 칼럼이 있어서 해당 내용을 가져오려 한다.
    .execute();
const uuid = insertResult[0].uuid; // uuid값을 받아오는 데에 성공.
```

### turmite
[Turmite - Wikipedia](https://en.wikipedia.org/wiki/Turmite){:target="_blank"}  
현재의 상태와 방향을 가진, 무한한 2차원의 그리드로 된 셀로 이루어진 테이프로 작동하는 튜링머신. 무슨 말인지 하나씩 뜯어보면

- 원래 튜링머신에서 하나의 셀은 하나의 기호를 들고 있을 수 있다. 예를 들어, 셀이 'A'라는 기호를 들고 있을 수 있다.
- 튜링 머신은 상태를 가진다. 예를 들어, 현재의 상태가 '1'이라고 할 수 있다.
- 튜링머신은 주어진 규칙에 따라 작동한다. 예를 들어, "현재 상태가 x이고 셀에 y가 적혀있을때 상태를 x'으로 바꾸고 다음 셀에 y'을 적는다." 같은 작업을 수행할 수 있다.
- turmite에서는 이 셀이 들고 있는 것이 하나의 기호가 아니라 무한한 2차원 그리드라고 보면 된다.
- 방향을 가지고 있다는 말은, 2차원의 그리드를 읽을때 방향이 중요하다는 것.
    - 즉, 주어진 그리드를 회전시키면 다른 정보가 된다.
    - 예를 들어, 규칙에 "현재 상태가 (x, y)일때 (x, y)에 해당하는 그리드에 점을 찍고 상태를 북쪽으로 한 칸 이동한다"라고 되어있다 하자.
    - 원래의 셀에서 북쪽으로 한 칸 가는 것과, 셀의 그리드를 시계방향으로 90도 회전시킨 다음 북쪽으로 한 칸 가는 것이 서로 다른 결과가 나오므로 방향이라는 정보가 중요함.

langton's ant같은 것이 이런 turmite에 속한다. 그 외에도 흥미로운 패턴들이 많이 있는 것을 볼 수 있는데, 나중에 좀 더 살펴볼 예정.

### C#에서 특정 문자열 n번 반복하기
아래와 같은 방식으로 n번 반복되는 문자열을 띄어쓰기로 구분해서 붙일 수 있다.
```c#
string.Join(" ",Enumerable.Repeat(i,n))
```

[:material-arrow-left-bold: 이전 페이지](../index.md){ .md-button }  